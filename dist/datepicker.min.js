!function(e){function t(a){function l(e,t){var a=[],l=new Date(e,t-1,1),r=l.getDay(),c=0;if(r!=s.weekStart){l.setDate(0);var h=l.getDate(),c=r-s.weekStart;0>c&&(c+=7);for(var u=c-1;u>=0;u--)a.push({value:i(l.getFullYear(),l.getMonth()+1,h-u),date:h-u,"class":"prev-month"})}l.setFullYear(e,t,0);for(var u=1,v=l.getDate();v>=u;u++)a.push({value:i(l.getFullYear(),l.getMonth()+1,u),date:u,"class":"curr-month"});var f=d();if(f.year==e&&f.month==t&&(a[c+f.day-1]["class"]+=" selected"),a.length%7>0){l.setFullYear(e,t,1);for(var u=1,v=7-a.length%7;v>=u;u++)a.push({value:i(l.getFullYear(),l.getMonth()+1,u),date:u,"class":"next-month"})}p.find(".datepicker-select-year .datepicker-select-selected").data("year",e).text(e+o.yearText),p.find(".datepicker-select-month .datepicker-select-selected").data("month",t).text(t+o.monthText),p.find(".body tbody").html(n(a))}function n(e){var t=[];t.push("<tr>");for(var a=0,l=e.length;l>a;a++)t.push('<td class="cell '+e[a]["class"]+'" data-value="'+e[a].value+'">'+e[a].date+"</td>"),(a+1)%7==0&&a!=l-1&&t.push("</tr></tr>");return t.push("</tr>"),t.join("")}function i(e,t,a){return t=10>t?"0"+t:t,a=10>a?"0"+a:a,e+"-"+t+"-"+a}function d(){var e={},t=r.val();if(/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(t)){var a=t.split("-");e={year:a[0]-0,month:a[1]-0,day:a[2]-0}}else{var l=new Date;e={year:l.getFullYear(),month:l.getMonth()+1,day:l.getDate()}}return e}var r=e(this),c=r.offset(),s={weekStart:1,yearRange:[-6,7],language:"zh_CN"};e.extend(s,a);var o=t.language[s.language],h='<div class="datepicker" id="datepicker">                    <div class="top">                        <div class="datepicker-select datepicker-select-year">                            <div class="datepicker-select-selected"></div>                            <ul class="datepicker-select-option">                            {{yearRange}}                            </ul>                        </div>                        <div class="datepicker-select datepicker-select-month">                            <div class="datepicker-select-selected"></div>                                <ul class="datepicker-select-option">                                    <li data-month="1">&ensp;1</li>                                    <li data-month="7">&ensp;7</li>                                    <li data-month="2">&ensp;2</li>                                    <li data-month="8">&ensp;8</li>                                    <li data-month="3">&ensp;3</li>                                    <li data-month="9">&ensp;9</li>                                    <li data-month="4">&ensp;4</li>                                    <li data-month="10">10</li>                                    <li data-month="5">&ensp;5</li>                                    <li data-month="11">11</li>                                    <li data-month="6">&ensp;6</li>                                    <li data-month="12">12</li>                                </ul>                            </div>                        </div>                    <table class="body">                        <thead>                            <tr>                                {{weekHead}}                            </tr>                        </thead>                        <tbody>                        </tbody>                    </table>                    <div class="bottom">                        <div class="btn-clear">{{clearText}}</div>                    </div>            </div>',u={yearRange:function(){for(var e=new Date,t=e.getFullYear()+s.yearRange[0],a=s.yearRange[1]-s.yearRange[0],l=Math.ceil(a/2),n=[],i=0;l>i;i++)n.push('<li data-year="'+(t+i)+'">'+(t+i)+"</li>"),n.push('<li data-year="'+(t+i+l)+'">'+(t+i+l)+"</li>");return a%2!=0&&n.pop(),n.join("")}(),weekHead:function(){for(var e=[],t=s.weekStart;t<s.weekStart+7;t++)e.push('<td class="cell week-cell">'+o.week[t%7]+"</td>");return e.join("")}(),clearText:o.clearText};h=h.replace(/\{\{(\w+)\}\}/g,function(e,t){return u[t]});var p=e(h).appendTo(document.body);return p.css({top:c.top+r.outerHeight(),left:c.left}).on("click",".datepicker-select",function(){var t=e(this).find(".datepicker-select-option");e(this).siblings(".datepicker-select").find(".datepicker-select-option").fadeOut(200),t.is(":hidden")?t.fadeIn(100):t.fadeOut(200)}).on("click",".datepicker-select-option li",function(){var t=e(this).data("year")||p.find(".datepicker-select-year .datepicker-select-selected").data("year"),a=e(this).data("month")||p.find(".datepicker-select-month .datepicker-select-selected").data("month");l(t,a)}).on("click",".curr-month,.prev-month,.next-month",function(){p.find(".selected").removeClass("selected"),e(this).addClass("selected");var t=e(this).data("value");r.val(t),p.hide()}).on("click",".btn-clear",function(){r.val(""),p.hide()}),r.on({focus:function(e){var t=d();l(t.year,t.month),p.find(".datepicker-select-option").hide(),p.show()}}),e(document).on("mousedown",function(t){var a=e(t.target);0!=a.closest(".datepicker").length||a.is(r)||p.hide()}),p}t.language={zh_CN:{yearText:"年",monthText:"月",clearText:"清除",week:["日","一","二","三","四","五","六"]}},e.fn.datepicker=t,e.fn.datepicker.language=t.language}(jQuery);